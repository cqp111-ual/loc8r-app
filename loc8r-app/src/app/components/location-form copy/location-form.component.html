<form #locationForm="ngForm" (ngSubmit)="onSubmit()" novalidate>

  <!-- Nombre (requerido) -->
  <ion-item>
    <ion-label position="floating">Nombre *</ion-label>
    <ion-input
      [(ngModel)]="name"
      name="name"
      required
      minlength="3"
      maxlength="100"
      #nameModel="ngModel"
      type="text"
    ></ion-input>  
  </ion-item>
  <ion-note color="danger" *ngIf="nameModel.invalid && (nameModel.dirty || nameModel.touched)">
    <ng-container *ngIf="nameModel.errors?.['required']">El nombre es obligatorio.</ng-container>
    <ng-container *ngIf="nameModel.errors?.['minlength']">El nombre debe tener al menos 3 caracteres.</ng-container>
    <ng-container *ngIf="nameModel.errors?.['maxlength']">El nombre no puede tener más de 100 caracteres.</ng-container>
  </ion-note>

  <!-- Dirección (opcional, max 200) -->
  <ion-item>
    <ion-label position="floating">Dirección</ion-label>
    <ion-input
      [(ngModel)]="address"
      name="address"
      maxlength="200"
      #addressModel="ngModel"
      type="text"
    ></ion-input>
  </ion-item>
  <ion-note color="danger" *ngIf="addressModel.invalid && (addressModel.dirty || addressModel.touched)">
    <ng-container *ngIf="addressModel.errors?.['maxlength']">La dirección no puede tener más de 200 caracteres.</ng-container>
  </ion-note>

  <!-- Descripción (opcional, max 500) -->
  <ion-item>
    <ion-label position="floating">Descripción</ion-label>
    <ion-textarea
      [(ngModel)]="description"
      name="description"
      maxlength="500"
      #descriptionModel="ngModel"
    ></ion-textarea>
  </ion-item>
  <ion-note color="danger" *ngIf="descriptionModel.invalid && (descriptionModel.dirty || descriptionModel.touched)">
    <ng-container *ngIf="descriptionModel.errors?.['maxlength']">La descripción no puede tener más de 500 caracteres.</ng-container>
  </ion-note>

  <!-- Coordenadas (requerido, validación manual abajo) -->
  <ion-item>
    <ion-label position="floating">Coordenadas * (ejemplo: [40.453026, -3.688322])</ion-label>
    <ion-input
      [(ngModel)]="coordinates"
      name="coordinates"
      required
      #coordsModel="ngModel"
      type="text"
    ></ion-input>
  </ion-item>
  <ion-note color="danger" *ngIf="coordsModel.invalid && (coordsModel.dirty || coordsModel.touched)">
    <ng-container *ngIf="coordsModel.errors?.['required']">Las coordenadas son obligatorias.</ng-container>
  </ion-note>
  <ion-note color="danger" *ngIf="coordinates && !isValidCoordinates(coordinates)">
    Formato inválido. Debe ser un JSON array con dos números, ej: [40.453026, -3.688322]
  </ion-note>

  <!-- Tags (opcional, validación manual abajo) -->
  <ion-item>
    <ion-label position="floating">Tags (ejemplo: ["Stadium", "Tourist"])</ion-label>
    <ion-input
      [(ngModel)]="tags"
      name="tags"
      #tagsModel="ngModel"
      type="text"
    ></ion-input>
  </ion-item>
  <ion-note color="danger" *ngIf="tags && !isValidTags(tags)">
    Formato inválido. Debe ser un JSON array de strings, ej: ["Stadium","Tourist"]
  </ion-note>

  <!-- imageUrl (opcional, validación URL) -->
  <ion-item>
    <ion-label position="floating">URL Imagen</ion-label>
    <ion-input
      [(ngModel)]="imageUrl"
      name="imageUrl"
      #imageUrlModel="ngModel"
      type="url"
      pattern="https?://.+"
    ></ion-input>
  </ion-item>
  <ion-note color="danger" *ngIf="imageUrl && imageUrlModel.invalid && (imageUrlModel.dirty || imageUrlModel.touched)">
    La URL debe ser válida (http o https).
  </ion-note>

  <!-- imageFile (opcional, validación en controlador) -->
  <ion-item>
    <ion-label position="floating">Archivo Imagen</ion-label>
    <input
      type="file"
      (change)="onFileChange($event)"
      accept=".jpg,.jpeg,.png,.webp"
    />
  </ion-item>
  <ion-note color="danger" *ngIf="fileError">{{ fileError }}</ion-note>

  <br />
  <ion-item class="test-item" [class.valid]="testStatus === 'valid'" [class.invalid]="testStatus === 'invalid'">
    <ion-input
      [(ngModel)]="testValue"
      name="test"
      label="Test Input"
      label-placement="floating"
      fill="outline"
      placeholder="Introduce texto"
      required
      minlength="3"
      [color]="testColor"
    >
      <ion-icon slot="end" [name]="testIcon" class="status-icon" aria-hidden="true"></ion-icon>
    </ion-input>
  </ion-item>
  <ion-note color="danger" *ngIf="testStatus === 'invalid'">
    El valor debe tener al menos 3 caracteres.
  </ion-note>

  <br />
  

  <ion-button expand="block" type="submit" [disabled]="!canSubmit">
    Enviar
  </ion-button>

</form>
